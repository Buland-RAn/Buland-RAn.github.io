<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>异常栈信息stack trace应该怎么用 | AYu</title>
  <meta name="author" content="AYu">
  
  <meta name="description" content="学习生活片段记录">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="异常栈信息stack trace应该怎么用"/>
  <meta property="og:site_name" content="AYu"/>

  
    <meta property="og:image" content=""/>
  

  
  
    <link href="/favicon.ico" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-70812759-1', 'auto');
  ga('send', 'pageview');
</script>



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?cb5448498d7169c668b07c2b255d62c1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


<meta name="generator" content="Hexo 5.0.2"><link rel="alternate" href="atom.xml" title="AYu" type="application/atom+xml">
</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">AYu</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archive" title="All the articles.">
			  <i class=""></i>Archive
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class=""></i>About
			</a>
		  </li>
		  
		  <li>
			<a href="/atom.xml" title="Subscribe me.">
			  <i class=""></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> 异常栈信息stack trace应该怎么用</h1>
		</div>
	


<script src='//unpkg.com/valine/dist/Valine.min.js'></script>

<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <p>本文详细总结了stack trace的各个部分的含义和使用方法，同时深入介绍了一些与异常相关的函数和最佳实践。<a id="more"></a></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li><a target="_blank" rel="noopener" href="https://www.scalyr.com/blog/java-stack-trace-understanding/">What’s a Java Stack Trace?</a></li>
<li><a target="_blank" rel="noopener" href="https://stackify.com/java-stack-trace/">Understanding and Leveraging the Java Stack Trace</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/ismallboy/p/12779200.html">如何看异常堆栈信息</a></li>
<li><a target="_blank" rel="noopener" href="https://www.twilio.com/blog/how-to-read-and-understand-a-java-stacktrace">Java Stack Trace: How to Read and Understand to Debug Code</a></li>
<li><a target="_blank" rel="noopener" href="https://riptutorial.com/java/example/1815/creating-and-reading-stacktraces">Creating and reading stacktraces</a></li>
<li><a target="_blank" rel="noopener" href="https://www.codejava.net/java-core/exception/understanding-exception-stack-trace-in-java-with-code-examples">Understanding Exception Stack Trace in Java with Code Examples</a></li>
</ol>
<h1 id="Call-Stack-函数调用栈-与-stack-trace"><a href="#Call-Stack-函数调用栈-与-stack-trace" class="headerlink" title="Call Stack 函数调用栈 与 stack trace"></a>Call Stack 函数调用栈 与 stack trace</h1><blockquote>
<p>The Stack, more accurately called the runtime or call stack, is a set of stack frames a program creates as it executes, organized in a stack data structure.</p>
</blockquote>
<p>函数调用栈是一个以栈的形式保存从程序开始到运行当时调用的所有函数栈的结构。</p>
<blockquote>
<p>Simply put, a stack trace is a representation of a call stack at a certain point in time, with each element representing a method invocation. The stack trace contains all invocations from the start of a thread until the point it’s generated. This is usually a position at which an exception takes place.</p>
</blockquote>
<p>Stack trace 则是call stack的一种展示形式，打印出函数的名字与相关代码行。</p>
<p>示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StackTrace</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    a();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">a</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    b();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">b</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    c();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">c</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    d();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">d</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Thread.dumpStack();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">java.lang.Exception: Stack trace</span><br><span class="line">at java.base/java.lang.Thread.dumpStack(Thread.java:<span class="number">1383</span>)</span><br><span class="line">at com.ericgoebelbecker.stacktraces.StackTrace.d(StackTrace.java:<span class="number">23</span>)</span><br><span class="line">at com.ericgoebelbecker.stacktraces.StackTrace.c(StackTrace.java:<span class="number">19</span>)</span><br><span class="line">at com.ericgoebelbecker.stacktraces.StackTrace.b(StackTrace.java:<span class="number">15</span>)</span><br><span class="line">at com.ericgoebelbecker.stacktraces.StackTrace.a(StackTrace.java:<span class="number">11</span>)</span><br><span class="line">at com.ericgoebelbecker.stacktraces.StackTrace.main(StackTrace.java:<span class="number">7</span>)</span><br></pre></td></tr></table></figure>

<p>栈信息从上往下读，最上面的是最后调用的函数，main调用a，a调用b，b调用c，c调用d，d调用dumpStack，这个函数输出以上信息。</p>
<blockquote>
<p>A Java stack trace is a snapshot of a moment in time. You can see where your application was and how it got there. That’s valuable insight that you can use a few different ways.</p>
</blockquote>
<h1 id="Java-Exception"><a href="#Java-Exception" class="headerlink" title="Java Exception"></a>Java Exception</h1><blockquote>
<p>Stack traces and exceptions are often associated with each other. When you see a Java application throw an exception, you usually see a stack trace logged with it. This is because of how exceptions work.</p>
<p>When Java code throws an exception, the runtime looks up the stack for a method that has a handler that can process it. If it finds one, it passes the exception to it. If it doesn’t, the program exits. So exceptions and the call stack are linked directly. Understanding this relationship will help you figure out why your code threw an exception.</p>
</blockquote>
<p>Java Exception机制通常是和call stack函数调用栈联系在一起的。当某个函数抛出了一个异常，JVM会查看调用栈，看哪个函数可以处理这个异常（有catch），若找到则把异常传过去，若没有则终止程序。</p>
<p>捕捉到异常后可以执行不同的操作，一个简单的选择是直接输出这个异常的信息：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (NullPointerException e) &#123;</span><br><span class="line">    System.err.println(e.getMessage());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>若没有能够处理这个异常的函数，异常会被JVM接管，JVM会输出它抛出地的函数调用栈信息：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Exception in thread <span class="string">&quot;main&quot;</span> java.lang.NullPointerException</span><br><span class="line">at com.ericgoebelbecker.stacktraces.StackTrace.d(StackTrace.java:<span class="number">29</span>)</span><br><span class="line">at com.ericgoebelbecker.stacktraces.StackTrace.c(StackTrace.java:<span class="number">24</span>)</span><br><span class="line">at com.ericgoebelbecker.stacktraces.StackTrace.b(StackTrace.java:<span class="number">20</span>)</span><br><span class="line">at com.ericgoebelbecker.stacktraces.StackTrace.a(StackTrace.java:<span class="number">16</span>)</span><br><span class="line">at com.ericgoebelbecker.stacktraces.StackTrace.main(StackTrace.java:<span class="number">9</span>)</span><br></pre></td></tr></table></figure>

<p>BUT 输出了这个信息不代表这个异常就一定没有被处理catch，<strong>一种情况</strong>是catch了以后又抛出了：</p>
<p><img src="/2021/how-to-read-and-use-stack-trace/image-20210709122348187.png" alt="image-20210709122348187"></p>
<p><strong>另一种情况</strong>是我们自己处理的时候输出了这个信息，只需要调用异常的printStackTrace()方法即可：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (NullPointerException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/how-to-read-and-use-stack-trace/image-20210709122607629.png" alt="image-20210709122607629"></p>
<p>即使捕捉异常的操作是在main中执行的，它仍会打印出抛出地的调用栈信息，这有利于我们找到异常的源头。</p>
<p>这两种情况打印的内容有些不同：没有处理而终止的异常打印时开头多了一行内容：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Exception in thread <span class="string">&quot;main&quot;</span></span><br></pre></td></tr></table></figure>



<h1 id="stack-trace各部分具体介绍"><a href="#stack-trace各部分具体介绍" class="headerlink" title="stack trace各部分具体介绍"></a>stack trace各部分具体介绍</h1><p>原文：参考资料4</p>
<p>The first line tells us the details of the Exception:</p>
<p><img src="/2021/how-to-read-and-use-stack-trace/9oHmXuXT7nRpdSueZHD8I3sK2yLPdkPLBv6Kj8kjzfkELh.width-500.png" alt="Example java stack trace"></p>
<p>This is a good start. Line 2 shows what code was running when that happened:</p>
<p><img src="/2021/how-to-read-and-use-stack-trace/Hrwf15FHX0DEpuBEw73N5Xy_7icjNt1TLXRaNiu_D82aHY.width-500.png" alt="how to read stack trace"></p>
<p>That helps us narrow down the problem, but what part of the code called <code>badMethod</code>? The answer is on the next line down, which can be read in the exact same way. And how did we get there? Look on the next line. And so on, until you get to the last line, which is the <code>main</code> method of the application. Reading the stack trace from bottom to top you can trace the exact path from the beginning of your code, right to the Exception.</p>
<h2 id="将stack-trace记录在log中而不是打印在控制台"><a href="#将stack-trace记录在log中而不是打印在控制台" class="headerlink" title="将stack trace记录在log中而不是打印在控制台"></a>将stack trace记录在log中而不是打印在控制台</h2><p>使用Log4j或者Logback时，可以通过error函数保存异常的调用栈信息：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">logger.error(“Something bad happened:”, e);</span><br></pre></td></tr></table></figure>

<p>日志中的内容将会是：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Something bad happened:</span><br><span class="line">java.lang.NullPointerException: Oops!</span><br><span class="line">at com.ericgoebelbecker.stacktraces.StackTrace.d(StackTrace.java:<span class="number">28</span>)</span><br><span class="line">at com.ericgoebelbecker.stacktraces.StackTrace.c(StackTrace.java:<span class="number">24</span>)</span><br><span class="line">at com.ericgoebelbecker.stacktraces.StackTrace.b(StackTrace.java:<span class="number">20</span>)</span><br><span class="line">at com.ericgoebelbecker.stacktraces.StackTrace.a(StackTrace.java:<span class="number">16</span>)</span><br><span class="line">at com.ericgoebelbecker.stacktraces.StackTrace.main(StackTrace.java:<span class="number">9</span>)</span><br></pre></td></tr></table></figure>





<h1 id="深入stack-trace"><a href="#深入stack-trace" class="headerlink" title="深入stack trace"></a>深入stack trace</h1><h2 id="StackTraceElement-class"><a href="#StackTraceElement-class" class="headerlink" title="StackTraceElement class"></a>StackTraceElement class</h2><p>这个类的每一个实例代表了stack trace中的一个元素。</p>
<p>API：</p>
<ul>
<li><em>getClassName</em> – returns the fully qualified name of the class containing the method invocation</li>
<li><em>getMethodName</em> – returns the name of the method containing the method invocation</li>
<li><em>getFileName</em> – returns the name of the source file associated with the class containing the method invocation</li>
<li><em>getLineNumber</em> – returns the line number of the source line containing the execution point</li>
</ul>
<p>更多查看 <a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/10/docs/api/java/lang/StackTraceElement.html">Java API documentation</a></p>
<h2 id="Thread-class"><a href="#Thread-class" class="headerlink" title="Thread class"></a>Thread class</h2><p>我们还可以通过调用Thread实例的getStackTrace()方法从线程得到了其stack trace。这个方法返回一个包含StackTraceElement实例的数组。</p>
<p>示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> StackTraceElement[] methodA() &#123;</span><br><span class="line">    <span class="keyword">return</span> methodB();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> StackTraceElement[] methodB() &#123;</span><br><span class="line">    Thread thread = Thread.currentThread();</span><br><span class="line">    <span class="keyword">return</span> thread.getStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">whenElementOneIsReadUsingThread_thenMethodUnderTestIsObtained</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    StackTraceElement[] stackTrace = <span class="keyword">new</span> StackElementExample().methodA();</span><br><span class="line">    StackTraceElement elementOne = stackTrace[<span class="number">1</span>];</span><br><span class="line">    assertEquals(<span class="string">&quot;com.stackify.stacktrace.StackElementExample&quot;</span>, elementOne.getClassName());</span><br><span class="line">    assertEquals(<span class="string">&quot;methodB&quot;</span>, elementOne.getMethodName());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>stackTrace[0]是getStackTrace这个方法本身的调用。</p>
<h2 id="Throwable-class"><a href="#Throwable-class" class="headerlink" title="Throwable class"></a>Throwable class</h2><p>除了可以对Exception e进行打印stack trace的操作（printStackTrace函数），我们还可以通过getStackTrace函数获得与Thread中相同的一个StackTraceElement数组：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> StackTraceElement[] methodC() &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        methodD();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable t) &#123;</span><br><span class="line">        <span class="keyword">return</span> t.getStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">methodD</span><span class="params">()</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> Throwable(<span class="string">&quot;A test exception&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">whenElementZeroIsReadUsingThrowable_thenMethodThrowingThrowableIsObtained</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    StackTraceElement[] stackTrace = <span class="keyword">new</span> StackElementExample().methodC();</span><br><span class="line">    StackTraceElement elementZero = stackTrace[<span class="number">0</span>];</span><br><span class="line">    assertEquals(<span class="string">&quot;com.stackify.stacktrace.StackElementExample&quot;</span>, elementZero.getClassName());</span><br><span class="line">    assertEquals(<span class="string">&quot;methodD&quot;</span>, elementZero.getMethodName());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="打印异常堆栈信息的函数-printStackTrace"><a href="#打印异常堆栈信息的函数-printStackTrace" class="headerlink" title="打印异常堆栈信息的函数 printStackTrace"></a>打印异常堆栈信息的函数 printStackTrace</h2><p>printStackTrace：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">printStackTrace</span><span class="params">(PrintStreamOrWriter s)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Guard against malicious overrides of Throwable.equals by</span></span><br><span class="line">    <span class="comment">// using a Set with identity equality semantics.</span></span><br><span class="line">    Set&lt;Throwable&gt; dejaVu =</span><br><span class="line">        Collections.newSetFromMap(<span class="keyword">new</span> IdentityHashMap&lt;Throwable, Boolean&gt;());</span><br><span class="line">    dejaVu.add(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">synchronized</span> (s.lock()) &#123;</span><br><span class="line">        <span class="comment">// Print our stack trace</span></span><br><span class="line">        s.println(<span class="keyword">this</span>);</span><br><span class="line">        StackTraceElement[] trace = getOurStackTrace();</span><br><span class="line">        <span class="keyword">for</span> (StackTraceElement traceElement : trace)</span><br><span class="line">            s.println(<span class="string">&quot;\tat &quot;</span> + traceElement);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Print suppressed exceptions, if any</span></span><br><span class="line">        <span class="keyword">for</span> (Throwable se : getSuppressed())</span><br><span class="line">            se.printEnclosedStackTrace(s, trace, SUPPRESSED_CAPTION, <span class="string">&quot;\t&quot;</span>, dejaVu);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Print cause, if any</span></span><br><span class="line">        Throwable ourCause = getCause();</span><br><span class="line">        <span class="keyword">if</span> (ourCause != <span class="keyword">null</span>)</span><br><span class="line">            ourCause.printEnclosedStackTrace(s, trace, CAUSE_CAPTION, <span class="string">&quot;&quot;</span>, dejaVu);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>printStackTrace内部调用printEnclosedStackTrace：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Print our stack trace as an enclosed exception for the specified</span></span><br><span class="line"><span class="comment">     * stack trace.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">printEnclosedStackTrace</span><span class="params">(PrintStreamOrWriter s,</span></span></span><br><span class="line"><span class="function"><span class="params">                                     StackTraceElement[] enclosingTrace,</span></span></span><br><span class="line"><span class="function"><span class="params">                                     String caption,</span></span></span><br><span class="line"><span class="function"><span class="params">                                     String prefix,</span></span></span><br><span class="line"><span class="function"><span class="params">                                     Set&lt;Throwable&gt; dejaVu)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">assert</span> Thread.holdsLock(s.lock());</span><br><span class="line">    <span class="keyword">if</span> (dejaVu.contains(<span class="keyword">this</span>)) &#123;</span><br><span class="line">        s.println(<span class="string">&quot;\t[CIRCULAR REFERENCE:&quot;</span> + <span class="keyword">this</span> + <span class="string">&quot;]&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        dejaVu.add(<span class="keyword">this</span>);</span><br><span class="line">        <span class="comment">// Compute number of frames in common between this and enclosing trace</span></span><br><span class="line">        StackTraceElement[] trace = getOurStackTrace();</span><br><span class="line">        <span class="keyword">int</span> m = trace.length - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> n = enclosingTrace.length - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (m &gt;= <span class="number">0</span> &amp;&amp; n &gt;=<span class="number">0</span> &amp;&amp; trace[m].equals(enclosingTrace[n])) &#123;</span><br><span class="line">            m--; n--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> framesInCommon = trace.length - <span class="number">1</span> - m;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Print our stack trace</span></span><br><span class="line">        s.println(prefix + caption + <span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; i++)</span><br><span class="line">            s.println(prefix + <span class="string">&quot;\tat &quot;</span> + trace[i]);</span><br><span class="line">        <span class="keyword">if</span> (framesInCommon != <span class="number">0</span>)</span><br><span class="line">            s.println(prefix + <span class="string">&quot;\t... &quot;</span> + framesInCommon + <span class="string">&quot; more&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Print suppressed exceptions, if any</span></span><br><span class="line">        <span class="keyword">for</span> (Throwable se : getSuppressed())</span><br><span class="line">            se.printEnclosedStackTrace(s, trace, SUPPRESSED_CAPTION,</span><br><span class="line">                                       prefix +<span class="string">&quot;\t&quot;</span>, dejaVu);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Print cause, if any</span></span><br><span class="line">        Throwable ourCause = getCause();</span><br><span class="line">        <span class="keyword">if</span> (ourCause != <span class="keyword">null</span>)</span><br><span class="line">            ourCause.printEnclosedStackTrace(s, trace, CAUSE_CAPTION, prefix, dejaVu);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="信息中的…-n-more是怎么来的"><a href="#信息中的…-n-more是怎么来的" class="headerlink" title="信息中的… n more是怎么来的"></a>信息中的… n more是怎么来的</h2><p>原文：参考资料3</p>
<p>示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestEx</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">fun1</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IOException(<span class="string">&quot;level 1 exception&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">fun2</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            fun1();</span><br><span class="line">            System.out.println(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IOException(<span class="string">&quot;level 2 exception&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">fun3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            fun2();</span><br><span class="line">            System.out.println(<span class="string">&quot;3&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;level 3 exception&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">new</span> TestEx().fun3();</span><br><span class="line">            System.out.println(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>调试输出：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Connected to the target VM, address: &#x27;127.0.0.1:57353&#x27;, transport: &#x27;socket&#x27;</span><br><span class="line">java.lang.RuntimeException: level 3 exception</span><br><span class="line">  at person.ismallboy.console.TestEx.fun3(TestEx.java:24)</span><br><span class="line">  at person.ismallboy.console.TestEx.main(TestEx.java:30)</span><br><span class="line">Caused by: java.io.IOException: level 2 exception</span><br><span class="line">  at person.ismallboy.console.TestEx.fun2(TestEx.java:15)</span><br><span class="line">  at person.ismallboy.console.TestEx.fun3(TestEx.java:21)</span><br><span class="line">  ... 1 more</span><br><span class="line">Caused by: java.io.IOException: level 1 exception</span><br><span class="line">  at person.ismallboy.console.TestEx.fun1(TestEx.java:7)</span><br><span class="line">  at person.ismallboy.console.TestEx.fun2(TestEx.java:12)</span><br><span class="line">  ... 2 more</span><br><span class="line">Disconnected from the target VM, address: &#x27;127.0.0.1:57353&#x27;, transport: &#x27;socket&#x27;</span><br></pre></td></tr></table></figure>

<p>printEnclosedStackTrace函数其实是一个回调输出堆栈的过程。隐藏部分堆栈，是为了提高性能，省略一些不必要的输出，输出的内容越多，io耗时越慢。</p>
<blockquote>
<p>The trace ends with an “… N more” which indicates that the last N frames are the same as for the previous exception.</p>
</blockquote>
<p>其实“… n more”的部分是重复的堆栈部分。我们分析一下上面这个函数“printEnclosedStackTrace”，翻译为“打印封闭堆栈跟踪信息”，“封闭”暂且可以理解为“完整的”，这个函数有两个比较重要的变量，分别是“enclosingTrace”和“trace ”，这两个参数是什么关系呢？其实可以简单理解为“enclosingTrace”是“trace ”的父级堆栈，函数printEnclosedStackTrace中的while循环，就是为倒序找出“enclosingTrace”和“trace ”中从哪一个栈帧开始就不一样了，即“enclosingTrace”和“trace ”是有一部分是一样的（从数组后面倒回来），就是为了算出有多少个栈帧信息是重复可以隐藏的，相同的栈帧就不用重复输出了。</p>
<p>每个异常都输出一个完整的堆栈信息的话，都是从main函数开始，到当前的函数的所有函数调用的栈帧信息，里面函数的调用栈帧信息都会包括外层的函数调用栈帧信息，所以都输出的话，很多都是重复的，为了提高效率，减少io以及输出的内容太多又杂乱，所以jvm以“… n more”的方式隐藏了重复的部分。</p>
<p>当然，如果想不隐藏，可以重写java.lang.Throwable#printEnclosedStackTrace，去掉while部分，就可以看到每个异常的完整堆栈信息了，可以参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/michaelehome/article/details/79484722%E6%9D%A5%E9%AA%8C%E8%AF%81%E3%80%82">https://blog.csdn.net/michaelehome/article/details/79484722来验证。</a></p>
<h1 id="Exception-chaining：cause"><a href="#Exception-chaining：cause" class="headerlink" title="Exception chaining：cause"></a>Exception chaining：cause</h1><h2 id="工程中的最佳实践：捕捉并抛出一个更加贴合实际的Exception"><a href="#工程中的最佳实践：捕捉并抛出一个更加贴合实际的Exception" class="headerlink" title="工程中的最佳实践：捕捉并抛出一个更加贴合实际的Exception"></a>工程中的最佳实践：捕捉并抛出一个更加贴合实际的Exception</h2><p>原文：参考资料4、6</p>
<p>Let’s say we are working on a big project that deals with fictional <code>FooBars</code>, and our code is going to be used by others. We might decide to catch the ArithmeticException from <code>Fraction</code> and re-throw it as something project-specific, which looks like this:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">         ....</span><br><span class="line">        Fraction.getFraction(x,y);</span><br><span class="line">         ....</span><br><span class="line">&#125; <span class="keyword">catch</span> ( ArithmeticException e )&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> MyProjectFooBarException(<span class="string">&quot;The number of FooBars cannot be zero&quot;</span>, e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Catching the <code>ArithmeticException</code> and rethrowing it has a few benefits:</p>
<ul>
<li>Our users are shielded from having to care about the <code>ArithmeticException</code> - giving us flexibility to change how commons-lang is used.</li>
<li>More context can be added, eg stating that it’s <em>the number of FooBars</em> that is causing the problem.</li>
<li>It can make stack traces easier to read, too, as we’ll see below.</li>
</ul>
<p>It isn’t necessary to catch-and-rethrow on <em>every</em> Exception, but where there seems to be a jump in the layers of your code, like calling into a library, it often makes sense.</p>
<p>注意到MyProjectFooBarException的构造器有两个参数，第二个就是cause，用来指明产生此异常的根异常。</p>
<p>Every Exception in Java has a <code>cause</code> field, and when doing a <em>catch-and-rethrow</em> like this then you should <em>always</em> set that to help people debug errors.</p>
<p>设置了cause后stack trace变成了这样：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Exception in thread &quot;main&quot; com.myproject.module.MyProjectFooBarException: The number of FooBars cannot be zero</span><br><span class="line">    at com.myproject.module.MyProject.anotherMethod(MyProject.java:19)</span><br><span class="line">    at com.myproject.module.MyProject.someMethod(MyProject.java:12)</span><br><span class="line">    at com.myproject.module.MyProject.main(MyProject.java:8)</span><br><span class="line">Caused by: java.lang.ArithmeticException: The denominator must not be zero</span><br><span class="line">    at org.apache.commons.lang3.math.Fraction.getFraction(Fraction.java:143)</span><br><span class="line">    at com.myproject.module.MyProject.anotherMethod(MyProject.java:17)</span><br><span class="line">    ... 2 more</span><br></pre></td></tr></table></figure>

<p>多了一行<code>Caused by：</code>和cause的栈信息。需要注意的是此时若要查看异常根源，需要找到最后的caused by后面的异常的第一个方法。</p>
<blockquote>
<p>The “Caused by:” is only included in the output when the primary exception’s <code>cause</code> is not <code>null</code>). Exceptions can be chained indefinitely, and in that case the stacktrace can have multiple “Caused by:” traces.</p>
</blockquote>
<p>SO, don’t handle exceptions in the intermediate layers, because code in the middle layers is often used by code in the higher layers. It’s responsibility of the code in the top-most layer to handle the exceptions. The top-most layer is typically the user interface such as command-line console, window or webpage. And typically we handle exceptions by showing a warning/error message to the user.</p>
<p>This good practice is illustrated by the following picture:</p>
<p><img src="/2021/how-to-read-and-use-stack-trace/exception_chaining_rule.png" alt="exception chaining rule"></p>
<p><img src="https://www.codejava.net/images/articles/javacore/exception/stacktrace/exception_chaining_rule.png" alt="exception chaining rule"></p>
<h1 id="stack-trace中类、方法名的表示的特殊情况"><a href="#stack-trace中类、方法名的表示的特殊情况" class="headerlink" title="stack trace中类、方法名的表示的特殊情况"></a>stack trace中类、方法名的表示的特殊情况</h1><p>The class and method names in the stack frames are the internal names for the classes and methods. You will need to recognize the following unusual cases:</p>
<ul>
<li>A nested or inner class will look like “OuterClass$InnerClass”.</li>
<li>An anonymous inner class will look like “OuterClass$1”, “OuterClass$2”, etcetera.</li>
<li>When code in a constructor, instance field initializer or an instance initializer block is being executed, the method name will be “”.</li>
<li>When code in a static field initializer or static initializer block is being executed, the method name will be “”.</li>
</ul>
<h1 id="将-stack-trace-转为String"><a href="#将-stack-trace-转为String" class="headerlink" title="将 stack trace 转为String"></a>将 stack trace 转为String</h1><p>有时候我们需要将栈信息转换为String以便后面的操作，通常的做法是 create a temporary <code>OutputStream</code> or <code>Writer</code> that writes to an in-memory buffer and pass that to the <code>printStackTrace(...)</code>.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the string representation of the stack trace.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> throwable the throwable</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the string.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">stackTraceToString</span><span class="params">(Throwable throwable)</span> </span>&#123;</span><br><span class="line">    StringWriter stringWriter = <span class="keyword">new</span> StringWriter();</span><br><span class="line">    throwable.printStackTrace(<span class="keyword">new</span> PrintWriter(stringWriter));</span><br><span class="line">    <span class="keyword">return</span> stringWriter.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> <a target="_blank" rel="noopener" href="http://commons.apache.org/proper/commons-lang/javadocs/api-2.6/org/apache/commons/lang/exception/ExceptionUtils.html#getStackTrace(java.lang.Throwable)">Apache Commons</a> 和 <a target="_blank" rel="noopener" href="http://google.github.io/guava/releases/snapshot/api/docs/com/google/common/base/Throwables.html#getStackTraceAsString(java.lang.Throwable)">Guava</a> 都提供有进行这个操作的工具方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">org.apache.commons.lang.exception.ExceptionUtils.getStackTrace(Throwable)</span><br><span class="line">com.google.common.base.Throwables.getStackTraceAsString(Throwable)</span><br></pre></td></tr></table></figure>

	  
	</div>

	<div>
  	<center>
	<div class="pagination">

    
    
    <a href="/2021/how-to-write-specification/" type="button" class="btn btn-default"><i
                class="fa fa-arrow-circle-o-left"></i> 上一页</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/2021/how-to-use-snapshot/" type="button" class="btn btn-default ">下一页<i
                class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>

    </center>
	</div>
	
	<!-- comment -->
	<!-- 
<section id="comment">
    <h2 class="title">留言</h2>

    
</section>
 -->


    <section id="comment">
        <h2 class="title">
            留言
        </h2>
        <div id="vcomments"></div>
        <script>
            new Valine({
                el: '#vcomments',
                appId: '8FWjWdEoyYxwoFgc2ET6DcSh-gzGzoHsz',
                appKey: 'DqH3LDGq73YqdepEDCcPgWhl',
                visitor: true,
                // avatar: 'hide',
                avatar: 'retro',
                // 这里设置CDN, 默认微博表情CDN
                // emojiCDN: 'https://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/',
                // // 表情title和图片映射
                // emojiMaps: {
                //     "smile": "e3/2018new_weixioa02_org.png",
                //     "lovely": "09/2018new_keai_org.png",
                //     // ... 更多表情
                // }
            })
        </script>
    </section>


    <style type="text/css">
        h2.title {
            font-size: 25px;
            margin-bottom: 27px;
        }

        .v[data-class=v] .vwrap {
            border: 3px solid #f0f0f0;
        }
    
        .v[data-class=v] .vwrap .vheader .vinput {
            border-bottom: 1.8px dashed #f5f5f5;
            color: #bebaba;
            font-size: 17px;
        }

        .v[data-class=v] .veditor {
            font-size: 1.2em;
            color: #b5b5b5;
        }

        .v[data-class=v] .vrow .vcol {
            
            font-size: 17px;
        }

        .v[data-class=v] .vicon {
            fill: #bebebe;
        }

        .v[data-class=v] .vrow {
            font-size: 0;
            padding: 10px 0 0;
        }

        .v[data-class=v] .vbtn {
            color: #d0cdcd;
        }
        
        .v[data-class=v] .vsys {
            padding: 0em 0em;
        }

        .v[data-class=v] .vcards .vcard {
            padding-top: 0em;
        }

        .v[data-class=v] p {
            margin-bottom: 0;
            color: #c0c0c0;
        }

        a:hover {
            font-weight: 800 !important;
        }

        .v[data-class=v] a:hover{
            color: #c66400;
            background: bottom !important;
        }

        .v[data-class=v] a.vnick:hover{
            color: #c66400 !important;
            background: bottom !important;
        }

        .v[data-class=v] .vwrap .vheader .vinput:focus {
            border-bottom-color: #ff7c29;
        }

    </style>





	</div> <!-- col-md-9/col-md-12 -->
		
	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2021-07-07 
	</div>
	
	<span id="busuanzi_container_page_pv">
		<i class="fa fa-eye"></i>
  		<span id="busuanzi_value_page_pv"></span>
    </span>

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/SoftwareConstruction/">SoftwareConstruction<span>9</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
		

	<!-- toc -->
	<div class="meta-widget">
	
	   <a data-toggle="collapse" data-target="#toc"><i class="fa fa-bars"></i></a>
	   <div id="toc" class="toc collapse in">
		   <span class="toc-title">Contents</span>
			<ol class="toc-article"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-article-text">参考资料</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#Call-Stack-%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E6%A0%88-%E4%B8%8E-stack-trace"><span class="toc-article-text">Call Stack 函数调用栈 与 stack trace</span></a></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#Java-Exception"><span class="toc-article-text">Java Exception</span></a></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#stack-trace%E5%90%84%E9%83%A8%E5%88%86%E5%85%B7%E4%BD%93%E4%BB%8B%E7%BB%8D"><span class="toc-article-text">stack trace各部分具体介绍</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E5%B0%86stack-trace%E8%AE%B0%E5%BD%95%E5%9C%A8log%E4%B8%AD%E8%80%8C%E4%B8%8D%E6%98%AF%E6%89%93%E5%8D%B0%E5%9C%A8%E6%8E%A7%E5%88%B6%E5%8F%B0"><span class="toc-article-text">将stack trace记录在log中而不是打印在控制台</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#%E6%B7%B1%E5%85%A5stack-trace"><span class="toc-article-text">深入stack trace</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#StackTraceElement-class"><span class="toc-article-text">StackTraceElement class</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Thread-class"><span class="toc-article-text">Thread class</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Throwable-class"><span class="toc-article-text">Throwable class</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E6%89%93%E5%8D%B0%E5%BC%82%E5%B8%B8%E5%A0%86%E6%A0%88%E4%BF%A1%E6%81%AF%E7%9A%84%E5%87%BD%E6%95%B0-printStackTrace"><span class="toc-article-text">打印异常堆栈信息的函数 printStackTrace</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E4%BF%A1%E6%81%AF%E4%B8%AD%E7%9A%84%E2%80%A6-n-more%E6%98%AF%E6%80%8E%E4%B9%88%E6%9D%A5%E7%9A%84"><span class="toc-article-text">信息中的… n more是怎么来的</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#Exception-chaining%EF%BC%9Acause"><span class="toc-article-text">Exception chaining：cause</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E5%B7%A5%E7%A8%8B%E4%B8%AD%E7%9A%84%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%EF%BC%9A%E6%8D%95%E6%8D%89%E5%B9%B6%E6%8A%9B%E5%87%BA%E4%B8%80%E4%B8%AA%E6%9B%B4%E5%8A%A0%E8%B4%B4%E5%90%88%E5%AE%9E%E9%99%85%E7%9A%84Exception"><span class="toc-article-text">工程中的最佳实践：捕捉并抛出一个更加贴合实际的Exception</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#stack-trace%E4%B8%AD%E7%B1%BB%E3%80%81%E6%96%B9%E6%B3%95%E5%90%8D%E7%9A%84%E8%A1%A8%E7%A4%BA%E7%9A%84%E7%89%B9%E6%AE%8A%E6%83%85%E5%86%B5"><span class="toc-article-text">stack trace中类、方法名的表示的特殊情况</span></a></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#%E5%B0%86-stack-trace-%E8%BD%AC%E4%B8%BAString"><span class="toc-article-text">将 stack trace 转为String</span></a>
		</div>
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	</div>
		

</div><!-- row -->



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2021 AYu
  
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a>,<a target="_blank" rel="noopener" href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>,<a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a> and <a href="http://getbootstrap.com/" target="_blank">BOOTSTRA.386</a>. 
     <br>     
     <span id="busuanzi_container_site_pv">
    	👀: <span id="busuanzi_value_site_pv"></span>    |   🙋: <span id="busuanzi_value_site_uv"></span>
	</span>
</p>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
